"use strict";(self.webpackChunktechdocs=self.webpackChunktechdocs||[]).push([[5512],{467:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>p,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var t=r(4848),i=r(8453);const s={title:"Encrypt & compress folder"},d=void 0,c={id:"encanddecdirs",title:"Encrypt & compress folder",description:"Using 7zip",source:"@site/docs/encanddecdirs.md",sourceDirName:".",slug:"/encanddecdirs",permalink:"/techdocs/docs/encanddecdirs",draft:!1,unlisted:!1,editUrl:"https://github.com/lfir/techdocs/edit/devel/docs/encanddecdirs.md",tags:[],version:"current",lastUpdatedBy:"Leandro",lastUpdatedAt:1726946238,formattedLastUpdatedAt:"Sep 21, 2024",frontMatter:{title:"Encrypt & compress folder"},sidebar:"defaultSidebar",previous:{title:"Docker & Docker Compose",permalink:"/techdocs/docs/docker"},next:{title:"Fedora & RHEL",permalink:"/techdocs/docs/fedora"}},o={},l=[{value:"Using 7zip",id:"using-7zip",level:2},{value:"Backup",id:"backup",level:3},{value:"List archive contents",id:"list-archive-contents",level:3},{value:"Restore (extract files with full paths to current directory)",id:"restore-extract-files-with-full-paths-to-current-directory",level:3},{value:"Verify archive",id:"verify-archive",level:3},{value:"Using gpgtar",id:"using-gpgtar",level:2},{value:"Save dir",id:"save-dir",level:3},{value:"List file contents",id:"list-file-contents",level:3},{value:"Restore (using key in keyring)",id:"restore-using-key-in-keyring",level:3},{value:"Using openssl",id:"using-openssl",level:2},{value:"Encrypt compressed directory",id:"encrypt-compressed-directory",level:3},{value:"Decrypt",id:"decrypt",level:3}];function a(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"using-7zip",children:"Using 7zip"}),"\n",(0,t.jsx)(n.h3,{id:"backup",children:"Backup"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'7zz a bk-"$(date +%d-%m-%y)".7z -mx=9 -mhe=on -pmy_password targetDir\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"-spf"})," can be used to preserve directory structure in the output when adding individual files."]})}),"\n",(0,t.jsx)(n.h3,{id:"list-archive-contents",children:"List archive contents"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"7zz l bkp.7z\n"})}),"\n",(0,t.jsx)(n.h3,{id:"restore-extract-files-with-full-paths-to-current-directory",children:"Restore (extract files with full paths to current directory)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"7zz x bkp.7z\n"})}),"\n",(0,t.jsx)(n.h3,{id:"verify-archive",children:"Verify archive"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"7zz t bkp.7z\n"})}),"\n",(0,t.jsx)(n.h2,{id:"using-gpgtar",children:"Using gpgtar"}),"\n",(0,t.jsx)(n.h3,{id:"save-dir",children:"Save dir"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'gpgtar --encrypt --output bk-"$(date +%d-%m-%y)".tar.gpg -r signingKeyEmail directory\n'})}),"\n",(0,t.jsx)(n.h3,{id:"list-file-contents",children:"List file contents"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"gpgtar --list-archive file.tar.gpg | less\n"})}),"\n",(0,t.jsx)(n.h3,{id:"restore-using-key-in-keyring",children:"Restore (using key in keyring)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"gpgtar --decrypt file.tar.gpg\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["A key pair (private + public) can be imported into the keyring with command: ",(0,t.jsx)(n.code,{children:"gpg --import private.key"}),"."]})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["On older distributions the program is called ",(0,t.jsx)(n.code,{children:"gpg-zip"}),". The commands above work in the same way with it."]})}),"\n",(0,t.jsx)(n.h2,{id:"using-openssl",children:"Using openssl"}),"\n",(0,t.jsx)(n.h3,{id:"encrypt-compressed-directory",children:"Encrypt compressed directory"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'tar cf - directory | openssl enc -e -aes256 -pbkdf2 -out bk-"$(date -I)".tar.enc -pass pass:my_password\n'})}),"\n",(0,t.jsx)(n.h3,{id:"decrypt",children:"Decrypt"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"openssl enc -d -aes256 -pbkdf2 -in dir.tar.enc -out dir.tar -pass pass:my_password\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["If ",(0,t.jsx)(n.code,{children:"-pass"})," option is not used the password has to be entered manually when prompted."]})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>c});var t=r(6540);const i={},s=t.createContext(i);function d(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);