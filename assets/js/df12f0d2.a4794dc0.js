"use strict";(self.webpackChunktechdocs=self.webpackChunktechdocs||[]).push([[9500],{6959:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>d});var s=r(4848),l=r(8453);const a={title:"Fedora & RHEL"},i=void 0,t={id:"fedora",title:"Fedora & RHEL",description:"Change locale and keyboard layout",source:"@site/docs/fedora.md",sourceDirName:".",slug:"/fedora",permalink:"/techdocs/docs/fedora",draft:!1,unlisted:!1,editUrl:"https://github.com/lfir/techdocs/edit/devel/docs/fedora.md",tags:[],version:"current",lastUpdatedBy:"Asta86",lastUpdatedAt:1725244482,formattedLastUpdatedAt:"Sep 2, 2024",frontMatter:{title:"Fedora & RHEL"},sidebar:"defaultSidebar",previous:{title:"Encrypt & compress folder",permalink:"/techdocs/docs/encanddecdirs"},next:{title:"Formulas",permalink:"/techdocs/docs/formulas"}},o={},d=[{value:"Change locale and keyboard layout",id:"change-locale-and-keyboard-layout",level:2},{value:"Check current settings",id:"check-current-settings",level:3},{value:"See available locales",id:"see-available-locales",level:3},{value:"Set locale",id:"set-locale",level:3},{value:"See available keyboard layouts",id:"see-available-keyboard-layouts",level:3},{value:"Set keyboard layout",id:"set-keyboard-layout",level:3},{value:"Delete older kernels &amp; limit max allowed",id:"delete-older-kernels--limit-max-allowed",level:2},{value:"Get name of installed packages with rpm",id:"get-name-of-installed-packages-with-rpm",level:2},{value:"Get release version",id:"get-release-version",level:2},{value:"Manually build kernel modules installed for current kernel",id:"manually-build-kernel-modules-installed-for-current-kernel",level:2},{value:"Network proxy",id:"network-proxy",level:2},{value:"Set proxy server using environment variables",id:"set-proxy-server-using-environment-variables",level:3},{value:"Package repository",id:"package-repository",level:3},{value:"Package groups",id:"package-groups",level:2},{value:"Get available and installed groups",id:"get-available-and-installed-groups",level:3},{value:"List packages in group",id:"list-packages-in-group",level:3},{value:"Install a group of packages",id:"install-a-group-of-packages",level:3},{value:"Release upgrade using dnf",id:"release-upgrade-using-dnf",level:2},{value:"Remote control with VNC over SSH",id:"remote-control-with-vnc-over-ssh",level:2},{value:"Install VNC server",id:"install-vnc-server",level:3},{value:"Create config. file to give access to root and another user",id:"create-config-file-to-give-access-to-root-and-another-user",level:3},{value:"Set VNC password",id:"set-vnc-password",level:3},{value:"Start VNC server and tunnel from the remote workstation",id:"start-vnc-server-and-tunnel-from-the-remote-workstation",level:3},{value:"Connect with a VNC client",id:"connect-with-a-vnc-client",level:3},{value:"RH Satellite",id:"rh-satellite",level:2},{value:"Manually register existing RHEL host",id:"manually-register-existing-rhel-host",level:3},{value:"RH Subscription Manager",id:"rh-subscription-manager",level:2},{value:"Register host with customer portal",id:"register-host-with-customer-portal",level:3},{value:"Attach a subscription",id:"attach-a-subscription",level:3},{value:"Get host subscription status",id:"get-host-subscription-status",level:3},{value:"Get available subscriptions",id:"get-available-subscriptions",level:3},{value:"List available repositories",id:"list-available-repositories",level:3},{value:"Remove current registrations",id:"remove-current-registrations",level:3},{value:"Remove current registration, subscriptions and local data",id:"remove-current-registration-subscriptions-and-local-data",level:3},{value:"Upgrade system except kernel",id:"upgrade-system-except-kernel",level:2}];function c(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"change-locale-and-keyboard-layout",children:"Change locale and keyboard layout"}),"\n",(0,s.jsx)(n.h3,{id:"check-current-settings",children:"Check current settings"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"localectl\n"})}),"\n",(0,s.jsx)(n.h3,{id:"see-available-locales",children:"See available locales"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"localectl list-locales\n"})}),"\n",(0,s.jsx)(n.h3,{id:"set-locale",children:"Set locale"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo localectl set-locale LANG=en_US.UTF-8\n"})}),"\n",(0,s.jsx)(n.h3,{id:"see-available-keyboard-layouts",children:"See available keyboard layouts"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"localectl list-keymaps\n"})}),"\n",(0,s.jsx)(n.h3,{id:"set-keyboard-layout",children:"Set keyboard layout"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo localectl set-keymap layoutCode\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo localectl set-x11-keymap layoutCode # For the graphical environment\n"})}),"\n",(0,s.jsx)(n.h2,{id:"delete-older-kernels--limit-max-allowed",children:"Delete older kernels & limit max allowed"}),"\n",(0,s.jsxs)(n.p,{children:["Install ",(0,s.jsx)(n.code,{children:"yum-utils"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo dnf install yum-utils\n"})}),"\n",(0,s.jsx)(n.p,{children:"Set count as how many old kernels you want left."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"package-cleanup --oldkernels --count=2\n"})}),"\n",(0,s.jsxs)(n.p,{children:["To make the amount of installed kernels permanent edit ",(0,s.jsx)(n.code,{children:"/etc/yum.conf"})," or\n",(0,s.jsx)(n.code,{children:"/etc/dnf/dnf.conf"})," and set ",(0,s.jsx)(n.code,{children:"installonly_limit"})," option."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"installonly_limit=2\n"})}),"\n",(0,s.jsx)(n.h2,{id:"get-name-of-installed-packages-with-rpm",children:"Get name of installed packages with rpm"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'rpm -qa --queryformat "%{NAME}\\n"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"get-release-version",children:"Get release version"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat /etc/redhat-release  # On RHEL\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat /etc/fedora-release  # On Fedora\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"lsb_release -ir   # On any of both\n"})}),"\n",(0,s.jsx)(n.h2,{id:"manually-build-kernel-modules-installed-for-current-kernel",children:"Manually build kernel modules installed for current kernel"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo akmods --force\n"})}),"\n",(0,s.jsx)(n.h2,{id:"network-proxy",children:"Network proxy"}),"\n",(0,s.jsx)(n.h3,{id:"set-proxy-server-using-environment-variables",children:"Set proxy server using environment variables"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"http_proxy"})," and ",(0,s.jsx)(n.code,{children:"https_proxy"})," environment variables are used to\nspecify proxy settings to client programs such as curl and wget."]}),"\n",(0,s.jsx)(n.h3,{id:"package-repository",children:"Package repository"}),"\n",(0,s.jsxs)(n.p,{children:["Add line ",(0,s.jsx)(n.code,{children:"proxy=proxyAddress"})," to .repo file in ",(0,s.jsx)(n.code,{children:"/etc/yum.repos.d"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"package-groups",children:"Package groups"}),"\n",(0,s.jsx)(n.h3,{id:"get-available-and-installed-groups",children:"Get available and installed groups"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"dnf grouplist\n"})}),"\n",(0,s.jsx)(n.h3,{id:"list-packages-in-group",children:"List packages in group"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"dnf groupinfo groupName\n"})}),"\n",(0,s.jsx)(n.h3,{id:"install-a-group-of-packages",children:"Install a group of packages"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo dnf groupinstall groupName\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Option ",(0,s.jsx)(n.code,{children:"--with-optional"})," includes optional packages of the group too."]}),"\n",(0,s.jsxs)(n.li,{children:["Option ",(0,s.jsx)(n.code,{children:"-x pkgName"})," excludes pkgName."]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"release-upgrade-using-dnf",children:"Release upgrade using dnf"}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:["Check that no repos exist with hardcoded release version in\n",(0,s.jsx)(n.code,{children:"/etc/yum.repos.d/"})]})}),"\n",(0,s.jsx)(n.p,{children:"Update current packages and install system upgrade plugin."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo dnf --refresh upgrade\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo dnf install dnf-plugin-system-upgrade\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Download the newer packages. Replace ",(0,s.jsx)(n.code,{children:"xy"})," with target version."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo dnf system-upgrade download --refresh --releasever=xy\n"})}),"\n",(0,s.jsx)(n.p,{children:"Trigger the upgrade process."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo dnf system-upgrade reboot\n"})}),"\n",(0,s.jsx)(n.h2,{id:"remote-control-with-vnc-over-ssh",children:"Remote control with VNC over SSH"}),"\n",(0,s.jsx)(n.h3,{id:"install-vnc-server",children:"Install VNC server"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo yum install tigervnc-server\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"xorg-x11"})," and a desktop environment need to be installed as well."]})}),"\n",(0,s.jsx)(n.h3,{id:"create-config-file-to-give-access-to-root-and-another-user",children:"Create config. file to give access to root and another user"}),"\n",(0,s.jsxs)(n.p,{children:["Save ",(0,s.jsx)(n.code,{children:"/etc/sysconfig/vncserver"})," with the following contents:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'VNCSERVERS="0:root,1:username" # Replace username with the actual name of the user\nVNCSERVERARGS[0]="-rfbport 5900"\nVNCSERVERARGS[1]="-rfbport 5901"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"set-vnc-password",children:"Set VNC password"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"vncpasswd # Run as each allowed user\n"})}),"\n",(0,s.jsx)(n.p,{children:"Since the idea is to connect only over SSH, the server will be started\nwhen needed from the remote machine through SSH and the insecure ports\ndon't need to be allowed in the firewall."}),"\n",(0,s.jsx)(n.h3,{id:"start-vnc-server-and-tunnel-from-the-remote-workstation",children:"Start VNC server and tunnel from the remote workstation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ssh user@ip 'vncserver -geometry 1280x1024 -autokill'\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ssh -NL 5901:localhost:5901 user@ip\n"})}),"\n",(0,s.jsx)(n.h3,{id:"connect-with-a-vnc-client",children:"Connect with a VNC client"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"localhost:5901 # or 5900\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["To disconnect log out from the desktop environment (vnc server is\nstopped automatically thanks to ",(0,s.jsx)(n.code,{children:"-autokill"})," option) and\n",(0,s.jsx)(n.code,{children:"Crtl+C"})," the SSH tunnel."]}),"\n",(0,s.jsx)(n.li,{children:"Tested on RHEL 7."}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"rh-satellite",children:"RH Satellite"}),"\n",(0,s.jsx)(n.h3,{id:"manually-register-existing-rhel-host",children:"Manually register existing RHEL host"}),"\n",(0,s.jsx)(n.p,{children:"Clean previous registration data."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo subscription-manager clean\n"})}),"\n",(0,s.jsx)(n.p,{children:"Get rhsm data from satellite server to register a host."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo rpm -Uhv http://satellite.example.com/pub/katello-ca-consumer-latest.noarch.rpm\n"})}),"\n",(0,s.jsx)(n.p,{children:"Register host."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'sudo subscription-manager register --org="orgName" --activationkey="key"\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo subscription-manager repos --list\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo yum install katello-agent\n"})}),"\n",(0,s.jsx)(n.h2,{id:"rh-subscription-manager",children:"RH Subscription Manager"}),"\n",(0,s.jsx)(n.h3,{id:"register-host-with-customer-portal",children:"Register host with customer portal"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo subscription-manager register --username userName\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Enter password when asked or pass it with ",(0,s.jsx)(n.code,{children:"--password passwd"}),"."]})}),"\n",(0,s.jsx)(n.h3,{id:"attach-a-subscription",children:"Attach a subscription"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo subscription-manager attach --pool=pool-id\n"})}),"\n",(0,s.jsx)(n.h3,{id:"get-host-subscription-status",children:"Get host subscription status"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo subscription-manager status\n"})}),"\n",(0,s.jsx)(n.h3,{id:"get-available-subscriptions",children:"Get available subscriptions"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo subscription-manager list --available\n"})}),"\n",(0,s.jsx)(n.h3,{id:"list-available-repositories",children:"List available repositories"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo subscription-manager repos --list\n"})}),"\n",(0,s.jsx)(n.h3,{id:"remove-current-registrations",children:"Remove current registrations"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo subscription-manager remove --all\n"})}),"\n",(0,s.jsx)(n.h3,{id:"remove-current-registration-subscriptions-and-local-data",children:"Remove current registration, subscriptions and local data"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo subscription-manager clean\n"})}),"\n",(0,s.jsx)(n.h2,{id:"upgrade-system-except-kernel",children:"Upgrade system except kernel"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo dnf upgrade -x kernel*\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>t});var s=r(6540);const l={},a=s.createContext(l);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);